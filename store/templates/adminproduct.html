{% extends "index.html" %}
{% block content %}
{% load static %}


<div class="table-responsive">
<a href="/export_product_csv" class="d-none d-sm-inline-block btn btn-sm btn-primary shadow-sm"><i class="fas fa-download fa-sm text-white-50"></i>Product All Data</a>

<a href="/export_product_csv_month" class="d-none d-sm-inline-block btn btn-sm btn-primary shadow-sm"><i class="fas fa-download fa-sm text-white-50"></i>Product Month Data</a>


<a href="/export_product_csv_week" class="d-none d-sm-inline-block btn btn-sm btn-primary shadow-sm"><i class="fas fa-download fa-sm text-white-50"></i>Product Week Data</a>

<a href="/export_product_csv_day" class="d-none d-sm-inline-block btn btn-sm btn-primary shadow-sm"><i class="fas fa-download fa-sm text-white-50"></i>Product Day Data</a>

<div class="row">
    <div class="col">
        <div class="card card-body">
            <form method="get">
                {{ myFilter.form.as_p }}<br>
                <button class="btn btn-primary" type="submit">Search</button>
            </form>

            <p><a href="/export_search_csv?{{ request.GET.urlencode }}/" class="d-none d-sm-inline-block btn btn-sm btn-primary shadow-sm"><i class="fas fa-download fa-sm text-white-50"></i>Export to CSV</a></p>
            <p><button onclick="document.getElementById('id01').style.display='block'" class='btn btn-danger' >Delete all Products</button></p>
            
            <div id="id01" class="modal" >
              <span onclick="document.getElementById('id01').style.display='none'" class="close" title="Close Modal">Ã—</span>
              <form class="modal-content">
                <div class="container">
                  <h1>Delete Bulk Products</h1>
                  <p>Are you sure you want to delete all the products</p>
                
                  <div class="clearfix">
                    <a href="/bulkdestroy/yes" class='btn btn-info'>Yes</a>
                    <a href="/bulkdestroy/no" class='btn btn-info'>No</a>
                  </div>
                </div>
              </form>
            </div>
          </div>
    </div>


<table class="table table-striped table-bordered table-sm">
    <thead class="thead-dark">
        <tr>
                                            
            <th>SKU ID</th>
            <th>PRODUCT NAME</th>
            <!-- <th>DESCRIPTION</th> -->
            <th>PRICE</th>
            <th>CATEGORY</th>
            <!-- <th>WEIGHT</th> -->
           <!--  <th>SIZE</th>
            <th>SUB CATEGORY</th> -->
            <th>COMPANY</th>
            <th>MODEL NO</th>
            <th>ACTION</th>
            <th>IMAGE 1</th>
            <!-- <th>IMAGE 2</th>
            <th>IMAGE 3</th> -->
        </tr>
     </thead>

    <tbody>
        {% for product in products %}
        <tr>
                                            
            <td>{{ product.sku}}</td>
            <td>{{ product.title }}</td>
            <!-- <td>{{ product.description|slice:"0:23"}}...</td> -->
            <td>{{ product.price }}</td>
            <td>{{ product.category }}</td>
            <!-- <td>{{ product.weight }}</td> -->
            <!-- <td>{{ product.size }}</td> -->
            <!-- <td>{{ product.sub_category }}</td> -->
	          <td>{{ product.company }}</td>
            <td>{{ product.model_No }}</td>                                 
            <td><a href="/edit/{{ product.id }}" class='btn btn-warning'>Edit</a><br>
                <a href="/delete/{{ product.id }}" class='btn btn-danger'>Delete</a>
                {% if product.add_recent == False %}
                    <a href="/addrecent/{{product.id}}" class='btn btn-info'>Add Recent</a>
                {% endif %}                              
            </td>                             
            <td><img src="{{product.images1.url}}" alt="img1" height="100" width="100"></td><!-- 
            <td><img src="{{product.images2.url}}" alt="img2" height="100" width="100"></td>
            <td><img src="{{product.images3.url}}" alt="img3" height="100" width="100"></td> -->                                    
        </tr>
        {% endfor %}
    </tbody>
</table>
<div class='pagination'>
   <nav aria-label="Page navigation example">
      <ul class="pagination">
        {% if products.has_previous %}
          <li class="page-item">
            <a class="page-link" href="?page={{products.previous_page_number}}" aria-label="Previous">
              <span aria-hidden="true">&laquo;</span>
              <span class="sr-only">Previous</span>
            </a>
          </li>
        {% endif %}

        {% for num in products.paginator.page_range %}
           {% if products.number == num %}

             <li class="page-item">
              <li class="page-item active">
                <a class="page-link" href="?page={{num}}">{{num}}<span class="sr-only">(current)</span></a>
              </li>
            </li>

           {% elif num > products.number|add:'-3' and num < products.number|add:'+3' %}
             <li class="page-item"><a class="page-link" href="?page={{num}}">{{num}}</a></li>

           {% else %}
             <li class="page-item"><a class="page-link" href="?page={{num}}">{{num}}</a></li>

           {% endif %}
        
        {% endfor %}

          {% if products.has_next %}
          <li class="page-item">
            <a class="page-link" href="?page={{products.next_page_number}}" aria-label="Next">
              <span aria-hidden="true">&raquo;</span>
              <span class="sr-only">Next</span>
            </a>
          </li>
            {% endif %}
      </ul>
    </nav> 
  </div>
</div>


<script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
  <script>
    $("#id_category").change(function () 
    {
      // var url = $("#personForm").attr("data-cities-url");  // get the url of the `load_cities` view
      var countryId = $(this).val();  // get the selected country ID from the HTML input
      $.ajax({                       // initialize an AJAX request
        url: '/ajax/load-company/',                    // set the url of the request (= localhost:8000/hr/ajax/load-cities/)
        data: {
          'country': countryId       // add the country id to the GET parameters
        },
        success: function (data) {  // `data` is the return of the `load_cities` view function
          $("#id_company").html(data);  // replace the contents of the city input with the data that came from the server
        }
      });

    });
  </script>


<script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
  <script>
    $("#id_company").change(function () 
    {
      // var url = $("#personForm").attr("data-cities-url");  // get the url of the `load_cities` view
      var countryId = $(this).val();  // get the selected country ID from the HTML input
      $.ajax({                       // initialize an AJAX request
        url: '/ajax/load-model/',                    // set the url of the request (= localhost:8000/hr/ajax/load-cities/)
        data: {
          'country': countryId       // add the country id to the GET parameters
        },
        success: function (data) 
        {  // `data` is the return of the `load_cities` view function
          $("#id_model_No").html(data);  // replace the contents of the city input with the data that came from the server
        }
      });

    });
  </script>
{% endblock content %}